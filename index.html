<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>ğ€ğ¥ğ¢ğ‚ğ¢ğ¯ğ¢ğ¥ ğ’ğ®ğ›ğ¬ğœğ«ğ¢ğ©ğ­ğ¢ğ¨ğ§ ğ†ğğ§ğğ«ğšğ­ğ¨ğ« By â˜¬SHÎNâ„¢</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- SweetAlert for better alerts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        :root {
            /* Modern Dark Theme with Blue Accent */
            --bg-primary: #0a0a0f;
            --bg-secondary: #15151f;
            --bg-card: #1a1a27;
            --bg-card-hover: #212130;
            --bg-input: #11111a;
            
            --text-primary: #f0f0ff;
            --text-secondary: #a0a0c0;
            --text-muted: #6a6a8a;
            
            --accent-primary: #3d8af7;
            --accent-secondary: #6c63ff;
            --accent-success: #4ade80;
            --accent-warning: #fbbf24;
            --accent-danger: #ef4444;
            
            --border-light: rgba(255, 255, 255, 0.08);
            --border-medium: rgba(255, 255, 255, 0.12);
            --border-heavy: rgba(255, 255, 255, 0.16);
            
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.2);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glow-blue: 0 0 20px rgba(61, 138, 247, 0.3);
            --glow-purple: 0 0 20px rgba(108, 99, 255, 0.3);
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            
            --transition-fast: 150ms ease;
            --transition-base: 250ms ease;
            --transition-slow: 350ms ease;
            
            --font-sans: 'Vazirmatn', system-ui, -apple-system, sans-serif;
            --font-mono: 'Roboto Mono', ui-monospace, monospace;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-sans);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(61, 138, 247, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(108, 99, 255, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(37, 99, 235, 0.03) 0%, transparent 50%);
            direction: rtl;
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--bg-card);
            border-radius: var(--radius-sm);
            border: 2px solid var(--bg-secondary);
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--bg-card-hover);
        }
        
        #root {
            min-height: 100vh;
        }
        
        /* Loading Animation */
        .loader {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-light);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Pulse Animation */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* Fade In Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Slide In Animation */
        @keyframes slideIn {
            from { transform: translateX(20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Toast/Notification */
        .toast {
            position: fixed;
            bottom: 24px;
            left: 24px;
            right: 24px;
            background: var(--bg-card);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-md);
            padding: 16px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            animation: slideIn var(--transition-base);
            display: flex;
            align-items: center;
            gap: 12px;
            max-width: 400px;
            margin: 0 auto;
        }
        
        .toast.success { border-right: 4px solid var(--accent-success); }
        .toast.error { border-right: 4px solid var(--accent-danger); }
        .toast.warning { border-right: 4px solid var(--accent-warning); }
        
        @media (min-width: 640px) {
            .toast {
                left: auto;
                right: 24px;
                max-width: 320px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel" data-presets="react">
        const { useState, useEffect, useRef, useCallback } = React;
        
        // Constants
        const OPERATORS = [
            { k: "", v: "ğŸ¯ Ù‡Ù…Ù‡ Ø§Ù¾Ø±Ø§ØªÙˆØ±Ù‡Ø§" },
            { k: "mci", v: "ğŸ“± Ù‡Ù…Ø±Ø§Ù‡â€ŒØ§ÙˆÙ„ (MCI)" },
            { k: "mtn", v: "ğŸ“¶ Ø§ÛŒØ±Ø§Ù†Ø³Ù„ (MTN)" },
            { k: "rtl", v: "ğŸ“¡ Ø±Ø§ÛŒØªÙ„ (RTL)" },
            { k: "mkh", v: "ğŸ¢ Ù…Ø®Ø§Ø¨Ø±Ø§Øª (MKH)" },
            { k: "hwb", v: "ğŸŒ Ù‡Ø§ÛŒâ€ŒÙˆØ¨ (HWB)" },
            { k: "ast", v: "ğŸ”— Ø¢Ø³ÛŒØ§ØªÚ© (AST)" },
            { k: "sht", v: "ğŸ“¶ Ø´Ø§ØªÙ„ (SHT)" },
            { k: "prs", v: "ğŸ’ Ù¾Ø§Ø±Ø³â€ŒØ¢Ù†Ù„Ø§ÛŒÙ† (PRS)" },
            { k: "mbt", v: "âš¡ Ù…Ø¨ÛŒÙ†â€ŒÙ†Øª (MBT)" },
            { k: "ask", v: "ğŸƒ Ø§Ù†Ø¯ÛŒØ´Ù‡â€ŒØ³Ø¨Ø² (ASK)" },
            { k: "rsp", v: "ğŸ”¥ Ø±Ø³Ù¾ÛŒÙ†Ø§ (RSP)" },
            { k: "afn", v: "ğŸš€ Ø§ÙØ±Ø§Ù†Øª (AFN)" },
            { k: "ztl", v: "ğŸ’« Ø²ÛŒâ€ŒØªÙ„ (ZTL)" },
        ];
        
        const COUNTRIES = [
            { code: "all", name: "ğŸŒ Ù‡Ù…Ù‡ Ú©Ø´ÙˆØ±Ù‡Ø§", flag: "ğŸŒ" },
            { code: "ir", name: "Ø§ÛŒØ±Ø§Ù†", flag: "ğŸ‡®ğŸ‡·" },
            { code: "us", name: "Ø¢Ù…Ø±ÛŒÚ©Ø§", flag: "ğŸ‡ºğŸ‡¸" },
            { code: "de", name: "Ø¢Ù„Ù…Ø§Ù†", flag: "ğŸ‡©ğŸ‡ª" },
            { code: "tr", name: "ØªØ±Ú©ÛŒÙ‡", flag: "ğŸ‡¹ğŸ‡·" },
            { code: "fr", name: "ÙØ±Ø§Ù†Ø³Ù‡", flag: "ğŸ‡«ğŸ‡·" },
            { code: "gb", name: "Ø§Ù†Ú¯Ù„ÛŒØ³", flag: "ğŸ‡¬ğŸ‡§" },
            { code: "nl", name: "Ù‡Ù„Ù†Ø¯", flag: "ğŸ‡³ğŸ‡±" },
            { code: "ca", name: "Ú©Ø§Ù†Ø§Ø¯Ø§", flag: "ğŸ‡¨ğŸ‡¦" },
            { code: "ru", name: "Ø±ÙˆØ³ÛŒÙ‡", flag: "ğŸ‡·ğŸ‡º" },
            { code: "ae", name: "Ø§Ù…Ø§Ø±Ø§Øª", flag: "ğŸ‡¦ğŸ‡ª" },
            { code: "ch", name: "Ø³ÙˆØ¦ÛŒØ³", flag: "ğŸ‡¨ğŸ‡­" },
        ];
        
        const PROTOCOLS = [
            { id: "vmess", name: "VMess", icon: "ğŸ”" },
            { id: "vless", name: "VLESS", icon: "âš¡" },
            { id: "trojan", name: "Trojan", icon: "ğŸ›¡ï¸" },
            { id: "shadowsocks", name: "Shadowsocks", icon: "ğŸ‘»" },
            { id: "wireguard", name: "WireGuard", icon: "ğŸ•¸ï¸" },
            { id: "tuic", name: "Tuic", icon: "ğŸš€" },
            { id: "hysteria", name: "Hysteria", icon: "ğŸŒŠ" },
        ];
        
        const NET_TYPES = [
            { id: "ws", name: "WebSocket", icon: "ğŸ”—" },
            { id: "grpc", name: "gRPC", icon: "ğŸ“" },
            { id: "tcp", name: "TCP", icon: "ğŸ“¡" },
            { id: "reality", name: "Reality", icon: "ğŸ›¡ï¸" },
            { id: "tls", name: "TLS", icon: "ğŸ”’" },
        ];
        
        // CORS Proxy (Cloudflare Worker)
        const CORS_PROXY = "https://cors-proxy.alicivil.workers.dev/?url=";
        
        // Components
        const Toast = ({ message, type, onClose }) => {
            useEffect(() => {
                const timer = setTimeout(onClose, 3000);
                return () => clearTimeout(timer);
            }, [onClose]);
            
            return ReactDOM.createPortal(
                <div className={`toast ${type}`}>
                    <i className={`fas ${
                        type === 'success' ? 'fa-check-circle' :
                        type === 'error' ? 'fa-exclamation-circle' :
                        'fa-info-circle'
                    }`} style={{
                        color: type === 'success' ? 'var(--accent-success)' :
                               type === 'error' ? 'var(--accent-danger)' :
                               'var(--accent-warning)'
                    }}></i>
                    <span>{message}</span>
                    <button onClick={onClose} style={{
                        marginRight: 'auto',
                        background: 'none',
                        border: 'none',
                        color: 'var(--text-secondary)',
                        cursor: 'pointer'
                    }}>
                        <i className="fas fa-times"></i>
                    </button>
                </div>,
                document.body
            );
        };
        
        const Card = ({ title, children, className = "", icon }) => (
            <div className={`card ${className}`} style={{
                background: 'var(--bg-card)',
                borderRadius: 'var(--radius-lg)',
                border: '1px solid var(--border-medium)',
                padding: '24px',
                marginBottom: '20px',
                transition: 'all var(--transition-base)',
                animation: 'fadeIn var(--transition-base)',
                boxShadow: 'var(--shadow-md)'
            }}>
                {(title || icon) && (
                    <div style={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: '12px',
                        marginBottom: '20px',
                        paddingBottom: '16px',
                        borderBottom: '1px solid var(--border-light)'
                    }}>
                        {icon && <span style={{ fontSize: '20px' }}>{icon}</span>}
                        <h3 style={{
                            margin: 0,
                            fontSize: '18px',
                            fontWeight: '600',
                            color: 'var(--text-primary)'
                        }}>{title}</h3>
                    </div>
                )}
                {children}
            </div>
        );
        
        const Input = ({ label, value, onChange, placeholder, type = "text", icon, info, ...props }) => {
            const [showInfo, setShowInfo] = useState(false);
            
            return (
                <div style={{ marginBottom: '16px' }}>
                    <div style={{
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'space-between',
                        marginBottom: '8px'
                    }}>
                        <label style={{
                            fontSize: '14px',
                            fontWeight: '500',
                            color: 'var(--text-secondary)',
                            display: 'flex',
                            alignItems: 'center',
                            gap: '6px'
                        }}>
                            {icon && <span>{icon}</span>}
                            {label}
                        </label>
                        {info && (
                            <div style={{ position: 'relative' }}>
                                <button onClick={() => setShowInfo(!showInfo)} style={{
                                    background: 'none',
                                    border: 'none',
                                    color: 'var(--text-muted)',
                                    cursor: 'pointer',
                                    width: '20px',
                                    height: '20px',
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontSize: '12px'
                                }}>
                                    <i className="fas fa-info-circle"></i>
                                </button>
                                {showInfo && (
                                    <div style={{
                                        position: 'absolute',
                                        left: '-180px',
                                        top: '30px',
                                        width: '200px',
                                        background: 'var(--bg-card)',
                                        border: '1px solid var(--border-medium)',
                                        borderRadius: 'var(--radius-md)',
                                        padding: '12px',
                                        fontSize: '12px',
                                        color: 'var(--text-secondary)',
                                        zIndex: 100,
                                        boxShadow: 'var(--shadow-lg)',
                                        animation: 'fadeIn var(--transition-fast)'
                                    }}>
                                        {info}
                                        <div style={{
                                            position: 'absolute',
                                            top: '-5px',
                                            right: '10px',
                                            width: '10px',
                                            height: '10px',
                                            background: 'var(--bg-card)',
                                            transform: 'rotate(45deg)',
                                            borderLeft: '1px solid var(--border-medium)',
                                            borderTop: '1px solid var(--border-medium)'
                                        }}></div>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                    <div style={{
                        position: 'relative',
                        display: 'flex',
                        alignItems: 'center'
                    }}>
                        <input
                            type={type}
                            value={value}
                            onChange={onChange}
                            placeholder={placeholder}
                            style={{
                                width: '100%',
                                padding: '14px 16px',
                                background: 'var(--bg-input)',
                                border: '1px solid var(--border-medium)',
                                borderRadius: 'var(--radius-md)',
                                color: 'var(--text-primary)',
                                fontSize: '14px',
                                fontFamily: 'var(--font-sans)',
                                transition: 'all var(--transition-fast)',
                                outline: 'none'
                            }}
                            onFocus={(e) => {
                                e.target.style.borderColor = 'var(--accent-primary)';
                                e.target.style.boxShadow = 'var(--glow-blue)';
                            }}
                            onBlur={(e) => {
                                e.target.style.borderColor = 'var(--border-medium)';
                                e.target.style.boxShadow = 'none';
                            }}
                            {...props}
                        />
                    </div>
                </div>
            );
        };
        
        const Select = ({ label, value, onChange, options, icon, ...props }) => (
            <div style={{ marginBottom: '16px' }}>
                <label style={{
                    fontSize: '14px',
                    fontWeight: '500',
                    color: 'var(--text-secondary)',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '6px',
                    marginBottom: '8px'
                }}>
                    {icon && <span>{icon}</span>}
                    {label}
                </label>
                <select
                    value={value}
                    onChange={onChange}
                    style={{
                        width: '100%',
                        padding: '14px 16px',
                        background: 'var(--bg-input)',
                        border: '1px solid var(--border-medium)',
                        borderRadius: 'var(--radius-md)',
                        color: 'var(--text-primary)',
                        fontSize: '14px',
                        fontFamily: 'var(--font-sans)',
                        cursor: 'pointer',
                        transition: 'all var(--transition-fast)',
                        outline: 'none',
                        appearance: 'none',
                        backgroundImage: `url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23a0a0c0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e")`,
                        backgroundRepeat: 'no-repeat',
                        backgroundPosition: 'left 16px center',
                        backgroundSize: '16px',
                        paddingLeft: '40px'
                    }}
                    onFocus={(e) => {
                        e.target.style.borderColor = 'var(--accent-primary)';
                        e.target.style.boxShadow = 'var(--glow-blue)';
                    }}
                    onBlur={(e) => {
                        e.target.style.borderColor = 'var(--border-medium)';
                        e.target.style.boxShadow = 'none';
                    }}
                    {...props}
                >
                    {options.map((option) => (
                        <option 
                            key={option.value || option.code || option.id || option.k} 
                            value={option.value || option.code || option.id || option.k}
                        >
                            {option.flag && `${option.flag} `}{option.name || option.v}
                        </option>
                    ))}
                </select>
            </div>
        );
        
        const ChipGroup = ({ label, options, selected, onChange, multi = false, icon }) => {
            const handleClick = (value) => {
                if (multi) {
                    if (selected.includes(value)) {
                        onChange(selected.filter(v => v !== value));
                    } else {
                        onChange([...selected, value]);
                    }
                } else {
                    onChange([value]);
                }
            };
            
            return (
                <div style={{ marginBottom: '16px' }}>
                    <label style={{
                        fontSize: '14px',
                        fontWeight: '500',
                        color: 'var(--text-secondary)',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '6px',
                        marginBottom: '12px'
                    }}>
                        {icon && <span>{icon}</span>}
                        {label}
                    </label>
                    <div style={{
                        display: 'flex',
                        flexWrap: 'wrap',
                        gap: '8px'
                    }}>
                        {options.map((option) => {
                            const value = option.id || option.k || option;
                            const label = option.name || option.v || option;
                            const optionIcon = option.icon;
                            const isSelected = multi ? selected.includes(value) : selected[0] === value;
                            
                            return (
                                <button
                                    key={value}
                                    onClick={() => handleClick(value)}
                                    type="button"
                                    style={{
                                        padding: '10px 16px',
                                        background: isSelected ? 'var(--accent-primary)' : 'var(--bg-input)',
                                        border: `1px solid ${isSelected ? 'var(--accent-primary)' : 'var(--border-medium)'}`,
                                        borderRadius: 'var(--radius-md)',
                                        color: isSelected ? 'white' : 'var(--text-secondary)',
                                        fontSize: '13px',
                                        fontWeight: isSelected ? '600' : '500',
                                        cursor: 'pointer',
                                        transition: 'all var(--transition-fast)',
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '6px',
                                        flexShrink: 0
                                    }}
                                    onMouseEnter={(e) => {
                                        if (!isSelected) {
                                            e.target.style.background = 'var(--bg-card-hover)';
                                            e.target.style.borderColor = 'var(--border-heavy)';
                                        }
                                    }}
                                    onMouseLeave={(e) => {
                                        if (!isSelected) {
                                            e.target.style.background = 'var(--bg-input)';
                                            e.target.style.borderColor = 'var(--border-medium)';
                                        }
                                    }}
                                >
                                    {optionIcon && <span>{optionIcon}</span>}
                                    {label}
                                </button>
                            );
                        })}
                    </div>
                </div>
            );
        };
        
        const Button = ({ children, onClick, variant = "primary", icon, loading = false, ...props }) => {
            const variants = {
                primary: {
                    background: 'var(--accent-primary)',
                    color: 'white',
                    border: 'none',
                    glow: 'var(--glow-blue)'
                },
                secondary: {
                    background: 'var(--bg-card)',
                    color: 'var(--text-primary)',
                    border: '1px solid var(--border-medium)'
                },
                danger: {
                    background: 'var(--accent-danger)',
                    color: 'white',
                    border: 'none'
                },
                success: {
                    background: 'var(--accent-success)',
                    color: 'white',
                    border: 'none'
                }
            };
            
            return (
                <button
                    onClick={onClick}
                    disabled={loading}
                    style={{
                        padding: '16px 24px',
                        background: variants[variant].background,
                        color: variants[variant].color,
                        border: variants[variant].border,
                        borderRadius: 'var(--radius-md)',
                        fontSize: '14px',
                        fontWeight: '600',
                        cursor: loading ? 'not-allowed' : 'pointer',
                        transition: 'all var(--transition-fast)',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        gap: '10px',
                        width: '100%',
                        opacity: loading ? 0.7 : 1
                    }}
                    onMouseEnter={(e) => {
                        if (!loading) {
                            e.target.style.transform = 'translateY(-2px)';
                            if (variant === 'primary') {
                                e.target.style.boxShadow = variants[variant].glow;
                            }
                        }
                    }}
                    onMouseLeave={(e) => {
                        if (!loading) {
                            e.target.style.transform = 'translateY(0)';
                            e.target.style.boxShadow = 'none';
                        }
                    }}
                    {...props}
                >
                    {loading ? (
                        <div className="loader" style={{ width: '20px', height: '20px' }}></div>
                    ) : (
                        <>
                            {icon && <i className={`fas ${icon}`}></i>}
                            {children}
                        </>
                    )}
                </button>
            );
        };
        
        const Tabs = ({ tabs, activeTab, onChange }) => (
            <div style={{
                display: 'flex',
                background: 'var(--bg-input)',
                borderRadius: 'var(--radius-md)',
                padding: '4px',
                marginBottom: '24px'
            }}>
                {tabs.map((tab) => (
                    <button
                        key={tab.id}
                        onClick={() => onChange(tab.id)}
                        style={{
                            flex: 1,
                            padding: '12px 16px',
                            background: activeTab === tab.id ? 'var(--accent-primary)' : 'transparent',
                            border: 'none',
                            borderRadius: 'var(--radius-sm)',
                            color: activeTab === tab.id ? 'white' : 'var(--text-secondary)',
                            fontSize: '14px',
                            fontWeight: '600',
                            cursor: 'pointer',
                            transition: 'all var(--transition-fast)',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            gap: '8px'
                        }}
                    >
                        {tab.icon && <span>{tab.icon}</span>}
                        {tab.label}
                    </button>
                ))}
            </div>
        );
        
        const OutputBox = ({ value }) => (
            <div style={{
                background: 'var(--bg-input)',
                border: '1px solid var(--border-medium)',
                borderRadius: 'var(--radius-md)',
                padding: '16px',
                fontFamily: 'var(--font-mono)',
                fontSize: '12px',
                color: 'var(--text-primary)',
                wordBreak: 'break-all',
                maxHeight: '200px',
                overflowY: 'auto',
                marginBottom: '20px',
                direction: 'ltr',
                lineHeight: 1.6
            }}>
                {value || <span style={{ color: 'var(--text-muted)', fontStyle: 'italic' }}>Ù„ÛŒÙ†Ú© ØªÙˆÙ„ÛŒØ¯ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯...</span>}
            </div>
        );
        
        // Main App Component
        const App = () => {
            // State
            const [baseUrl, setBaseUrl] = useState("https://v2.alicivil.workers.dev");
            const [count, setCount] = useState("100");
            const [shuffle, setShuffle] = useState("true");
            const [unique, setUnique] = useState("false");
            
            const [sourceMode, setSourceMode] = useState("country");
            const [selectedCountry, setSelectedCountry] = useState("all");
            const [listVal, setListVal] = useState("");
            const [operator, setOperator] = useState("");
            
            const [selectedProtocols, setSelectedProtocols] = useState([]);
            const [selectedNetTypes, setSelectedNetTypes] = useState([]);
            
            const [target, setTarget] = useState("");
            const [finalUrl, setFinalUrl] = useState("");
            
            const [toast, setToast] = useState(null);
            const [loading, setLoading] = useState(false);
            
            // Generate URL
            useEffect(() => {
                const params = new URLSearchParams();
                
                const addParam = (key, value) => {
                    if (value && value.toString().trim() !== "") {
                        params.set(key, value.toString().trim());
                    }
                };
                
                // Core params
                addParam("count", count);
                if (shuffle === "true") addParam("shuffle", "true");
                if (unique === "true") addParam("unique", "true");
                
                // Source
                if (sourceMode === "country") {
                    addParam("list", selectedCountry);
                } else if (sourceMode === "list" && listVal) {
                    addParam("list", listVal);
                }
                
                // Operator
                if (operator) addParam("operator", operator);
                
                // Protocols
                if (selectedProtocols.length > 0) {
                    addParam("protocol", selectedProtocols.join(","));
                }
                
                // Network types
                if (selectedNetTypes.length > 0) {
                    addParam("type", selectedNetTypes.join(","));
                }
                
                // Target
                if (target) addParam("target", target);
                
                // Build final URL
                const cleanBase = baseUrl.replace(/\/+$/, "");
                const queryString = params.toString();
                setFinalUrl(queryString ? `${cleanBase}/?${queryString}` : cleanBase);
                
            }, [baseUrl, count, shuffle, unique, sourceMode, selectedCountry, listVal, operator, selectedProtocols, selectedNetTypes, target]);
            
            // Show toast
            const showToast = (message, type = "success") => {
                setToast({ message, type });
            };
            
            // Copy to clipboard
            const copyToClipboard = async () => {
                try {
                    await navigator.clipboard.writeText(finalUrl);
                    showToast("âœ… Ù„ÛŒÙ†Ú© Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ú©Ù¾ÛŒ Ø´Ø¯", "success");
                } catch (err) {
                    showToast("âŒ Ø®Ø·Ø§ Ø¯Ø± Ú©Ù¾ÛŒ Ù„ÛŒÙ†Ú©", "error");
                }
            };
            
            // Download config with CORS proxy
            const downloadConfig = async () => {
                if (!finalUrl) {
                    showToast("âŒ Ø§Ø¨ØªØ¯Ø§ Ù„ÛŒÙ†Ú© Ø±Ø§ ØªÙˆÙ„ÛŒØ¯ Ú©Ù†ÛŒØ¯", "warning");
                    return;
                }
                
                setLoading(true);
                try {
                    // Use CORS proxy
                    const proxyUrl = `${CORS_PROXY}${encodeURIComponent(finalUrl)}`;
                    const response = await fetch(proxyUrl);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    const text = await response.text();
                    const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `alicivil-config-${Date.now()}.txt`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    showToast("âœ… Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯", "success");
                } catch (error) {
                    console.error('Download error:', error);
                    showToast(`âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø§Ù†Ù„ÙˆØ¯: ${error.message}`, "error");
                    
                    // Fallback: open in new tab
                    window.open(finalUrl, '_blank');
                } finally {
                    setLoading(false);
                }
            };
            
            // Open in Hiddify
            const openInHiddify = () => {
                if (!finalUrl) {
                    showToast("âŒ Ø§Ø¨ØªØ¯Ø§ Ù„ÛŒÙ†Ú© Ø±Ø§ ØªÙˆÙ„ÛŒØ¯ Ú©Ù†ÛŒØ¯", "warning");
                    return;
                }
                
                // Proper Hiddify URL format
                const hiddifyUrl = `hiddify://import/${encodeURIComponent(finalUrl)}`;
                window.location.href = hiddifyUrl;
                
                // Fallback after 1 second
                setTimeout(() => {
                    if (document.hasFocus()) {
                        showToast("âš ï¸ Ø§Ù¾ Ù‡ÛŒØ¯ÛŒÙØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯. Ù„ÛŒÙ†Ú© Ú©Ù¾ÛŒ Ø´Ø¯.", "warning");
                        navigator.clipboard.writeText(finalUrl);
                    }
                }, 1000);
            };
            
            // Reset form
            const resetForm = () => {
                setCount("100");
                setShuffle("true");
                setUnique("false");
                setSourceMode("country");
                setSelectedCountry("all");
                setListVal("");
                setOperator("");
                setSelectedProtocols([]);
                setSelectedNetTypes([]);
                setTarget("");
                showToast("â™»ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ø´Ø¯", "success");
            };
            
            return (
                <div style={{
                    maxWidth: '1200px',
                    margin: '0 auto',
                    padding: '24px',
                    minHeight: '100vh',
                    animation: 'fadeIn var(--transition-slow)'
                }}>
                    {/* Header */}
                    <header style={{
                        textAlign: 'center',
                        marginBottom: '40px',
                        paddingBottom: '24px',
                        borderBottom: '1px solid var(--border-light)'
                    }}>
                        <h1 style={{
                            fontSize: '32px',
                            fontWeight: '800',
                            background: 'linear-gradient(135deg, var(--accent-primary), var(--accent-secondary))',
                            WebkitBackgroundClip: 'text',
                            WebkitTextFillColor: 'transparent',
                            marginBottom: '12px',
                            letterSpacing: '-0.5px'
                        }}>
                            ğ€ğ¥ğ¢ğ‚ğ¢ğ¯ğ¢ğ¥ worker toolkit by â˜¬SHÎNâ„¢ 
                        </h1>
                        <p style={{
                            color: 'var(--text-secondary)',
                            fontSize: '16px',
                            maxWidth: '600px',
                            margin: '0 auto',
                            lineHeight: 1.6
                        }}>
                            Ø§Ø¨Ø²Ø§Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø³Ø§Ø¨Ø³Ú©Ø±ÛŒÙ¾Ø´Ù† Ù‡ÙˆØ´Ù…Ù†Ø¯ â€¢ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² ØªÙ…Ø§Ù…ÛŒ Ù¾Ø±ÙˆØªÚ©Ù„â€ŒÙ‡Ø§
                        </p>
                    </header>
                    
                    {/* Main Layout */}
                    <div style={{
                        display: 'grid',
                        gridTemplateColumns: '1fr 1fr',
                        gap: '24px',
                        alignItems: 'start'
                    }}>
                        {/* Left Column - Configuration */}
                        <div>
                            <Card title="ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾Ø§ÛŒÙ‡" icon="âš™ï¸">
                                <Input
                                    label="Ø¢Ø¯Ø±Ø³ Ø³Ø±ÙˆÛŒØ³"
                                    value={baseUrl}
                                    onChange={(e) => setBaseUrl(e.target.value)}
                                    placeholder="https://example.com"
                                    icon="ğŸŒ"
                                    info="Ø¢Ø¯Ø±Ø³ Ø³Ø±ÙˆØ± Ø§ØµÙ„ÛŒ Ú©Ù‡ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø±ÙˆÛŒ Ø¢Ù† Ù†ØµØ¨ Ø´Ø¯Ù‡ Ø§Ø³Øª"
                                />
                                
                                <div style={{
                                    display: 'grid',
                                    gridTemplateColumns: '1fr 1fr 1fr',
                                    gap: '16px'
                                }}>
                                    <Input
                                        label="ØªØ¹Ø¯Ø§Ø¯"
                                        type="number"
                                        value={count}
                                        onChange={(e) => setCount(e.target.value)}
                                        placeholder="100"
                                        icon="ğŸ“Š"
                                    />
                                    
                                    <Select
                                        label="ØªØ±Ú©ÛŒØ¨"
                                        value={shuffle}
                                        onChange={(e) => setShuffle(e.target.value)}
                                        options={[
                                            { value: "true", name: "âœ… ÙØ¹Ø§Ù„" },
                                            { value: "false", name: "âŒ ØºÛŒØ±ÙØ¹Ø§Ù„" }
                                        ]}
                                        icon="ğŸ”€"
                                    />
                                    
                                    <Select
                                        label="ÛŒÚ©ØªØ§"
                                        value={unique}
                                        onChange={(e) => setUnique(e.target.value)}
                                        options={[
                                            { value: "true", name: "âœ… ÙØ¹Ø§Ù„" },
                                            { value: "false", name: "âŒ ØºÛŒØ±ÙØ¹Ø§Ù„" }
                                        ]}
                                        icon="âœ¨"
                                    />
                                </div>
                            </Card>
                            
                            <Card title="Ù…Ù†Ø¨Ø¹ Ú©Ø§Ù†ÙÛŒÚ¯" icon="ğŸ—ºï¸">
                                <Tabs
                                    tabs={[
                                        { id: "country", label: "Ú©Ø´ÙˆØ±", icon: "ğŸŒ" },
                                        { id: "list", label: "Ù„ÛŒØ³Øª Ø¹Ø¯Ø¯ÛŒ", icon: "ğŸ”¢" }
                                    ]}
                                    activeTab={sourceMode}
                                    onChange={setSourceMode}
                                />
                                
                                {sourceMode === "country" ? (
                                    <Select
                                        label="Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø´ÙˆØ±"
                                        value={selectedCountry}
                                        onChange={(e) => setSelectedCountry(e.target.value)}
                                        options={COUNTRIES}
                                        icon="ğŸ“"
                                    />
                                ) : (
                                    <Input
                                        label="Ø´Ù…Ø§Ø±Ù‡ Ù„ÛŒØ³Øª (ID)"
                                        value={listVal}
                                        onChange={(e) => setListVal(e.target.value)}
                                        placeholder="Ù…Ø«Ø§Ù„: 100 ÛŒØ§ 1-5"
                                        icon="ğŸ”¢"
                                        info="Ø´Ù…Ø§Ø±Ù‡ Ù„ÛŒØ³Øª ÛŒØ§ Ø¨Ø§Ø²Ù‡ Ø¹Ø¯Ø¯ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯"
                                    />
                                )}
                                
                                <Select
                                    label="Ø§Ù¾Ø±Ø§ØªÙˆØ±"
                                    value={operator}
                                    onChange={(e) => setOperator(e.target.value)}
                                    options={OPERATORS}
                                    icon="ğŸ“¶"
                                />
                            </Card>
                            
                            <Card title="Ù¾Ø±ÙˆØªÚ©Ù„ Ùˆ Ø´Ø¨Ú©Ù‡" icon="ğŸ”§">
                                <ChipGroup
                                    label="Ù¾Ø±ÙˆØªÚ©Ù„â€ŒÙ‡Ø§"
                                    options={PROTOCOLS}
                                    selected={selectedProtocols}
                                    onChange={setSelectedProtocols}
                                    multi={true}
                                    icon="ğŸ”"
                                />
                                
                                <ChipGroup
                                    label="Ù†ÙˆØ¹ Ø´Ø¨Ú©Ù‡"
                                    options={NET_TYPES}
                                    selected={selectedNetTypes}
                                    onChange={setSelectedNetTypes}
                                    multi={true}
                                    icon="ğŸ“¡"
                                />
                            </Card>
                            
                            <Card title="Ø®Ø±ÙˆØ¬ÛŒ" icon="ğŸš€">
                                <Select
                                    label="ÙØ±Ù…Øª Ø®Ø±ÙˆØ¬ÛŒ"
                                    value={target}
                                    onChange={(e) => setTarget(e.target.value)}
                                    options={[
                                        { value: "", name: "ğŸ“¦ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ (V2Ray/Neko)" },
                                        { value: "hiddify", name: "ğŸ“± Ù‡ÛŒØ¯ÛŒÙØ§ÛŒ" },
                                        { value: "clash", name: "âš”ï¸ Clash Meta" },
                                        { value: "singbox", name: "ğŸµ Sing-box" }
                                    ]}
                                    icon="ğŸ“¤"
                                />
                            </Card>
                        </div>
                        
                        {/* Right Column - Output & Actions */}
                        <div>
                            <Card title="Ù„ÛŒÙ†Ú© ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡" icon="ğŸ”—">
                                <OutputBox value={finalUrl} />
                                
                                <div style={{
                                    display: 'grid',
                                    gridTemplateColumns: '1fr 1fr',
                                    gap: '12px',
                                    marginBottom: '16px'
                                }}>
                                    <Button
                                        onClick={copyToClipboard}
                                        icon="fa-copy"
                                        loading={loading}
                                    >
                                        Ú©Ù¾ÛŒ Ù„ÛŒÙ†Ú©
                                    </Button>
                                    
                                    <Button
                                        onClick={() => window.open(finalUrl, '_blank')}
                                        variant="secondary"
                                        icon="fa-external-link-alt"
                                        disabled={!finalUrl || loading}
                                    >
                                        ØªØ³Øª Ù„ÛŒÙ†Ú©
                                    </Button>
                                </div>
                                
                                <div style={{
                                    display: 'grid',
                                    gridTemplateColumns: '1fr 1fr',
                                    gap: '12px',
                                    marginBottom: '16px'
                                }}>
                                    <Button
                                        onClick={target === "hiddify" ? openInHiddify : downloadConfig}
                                        variant={target === "hiddify" ? "success" : "primary"}
                                        icon={target === "hiddify" ? "fa-mobile-alt" : "fa-download"}
                                        loading={loading}
                                    >
                                        {target === "hiddify" ? "Ù†ØµØ¨ Ø¯Ø± Ù‡ÛŒØ¯ÛŒÙØ§ÛŒ" : "Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ø§Ù†ÙÛŒÚ¯"}
                                    </Button>
                                    
                                    <Button
                                        onClick={resetForm}
                                        variant="danger"
                                        icon="fa-redo"
                                    >
                                        Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ
                                    </Button>
                                </div>
                            </Card>
                            
                            <Card title="ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…" icon="ğŸ“Š">
                                <div style={{
                                    display: 'grid',
                                    gridTemplateColumns: '1fr 1fr',
                                    gap: '16px',
                                    marginBottom: '16px'
                                }}>
                                    <div style={{
                                        background: 'var(--bg-input)',
                                        padding: '16px',
                                        borderRadius: 'var(--radius-md)',
                                        textAlign: 'center'
                                    }}>
                                        <div style={{
                                            fontSize: '12px',
                                            color: 'var(--text-muted)',
                                            marginBottom: '8px'
                                        }}>ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ù†ÙÛŒÚ¯</div>
                                        <div style={{
                                            fontSize: '24px',
                                            fontWeight: '700',
                                            color: 'var(--accent-primary)'
                                        }}>{count}</div>
                                    </div>
                                    
                                    <div style={{
                                        background: 'var(--bg-input)',
                                        padding: '16px',
                                        borderRadius: 'var(--radius-md)',
                                        textAlign: 'center'
                                    }}>
                                        <div style={{
                                            fontSize: '12px',
                                            color: 'var(--text-muted)',
                                            marginBottom: '8px'
                                        }}>Ø­Ø§Ù„Øª Ù…Ù†Ø¨Ø¹</div>
                                        <div style={{
                                            fontSize: '24px',
                                            fontWeight: '700',
                                            color: 'var(--accent-secondary)'
                                        }}>
                                            {sourceMode === 'country' ? 'ğŸŒ' : 'ğŸ”¢'}
                                        </div>
                                    </div>
                                </div>
                                
                                <div style={{
                                    background: 'var(--bg-input)',
                                    padding: '16px',
                                    borderRadius: 'var(--radius-md)',
                                    marginBottom: '16px'
                                }}>
                                    <div style={{
                                        fontSize: '12px',
                                        color: 'var(--text-muted)',
                                        marginBottom: '8px'
                                    }}>Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ ÙØ¹Ø§Ù„</div>
                                    <div style={{
                                        fontFamily: 'var(--font-mono)',
                                        fontSize: '11px',
                                        color: 'var(--text-secondary)',
                                        lineHeight: 1.6
                                    }}>
                                        <div>ğŸ”¹ ØªØ¹Ø¯Ø§Ø¯: {count}</div>
                                        <div>ğŸ”¹ ØªØ±Ú©ÛŒØ¨: {shuffle === "true" ? "âœ…" : "âŒ"}</div>
                                        <div>ğŸ”¹ ÛŒÚ©ØªØ§: {unique === "true" ? "âœ…" : "âŒ"}</div>
                                        <div>ğŸ”¹ Ù¾Ø±ÙˆØªÚ©Ù„â€ŒÙ‡Ø§: {selectedProtocols.length > 0 ? selectedProtocols.join(", ") : "Ù‡Ù…Ù‡"}</div>
                                        <div>ğŸ”¹ Ø§Ù¾Ø±Ø§ØªÙˆØ±: {operator || "Ù‡Ù…Ù‡"}</div>
                                    </div>
                                </div>
                                
                                <div style={{
                                    fontSize: '11px',
                                    color: 'var(--text-muted)',
                                    textAlign: 'center',
                                    padding: '8px',
                                    borderTop: '1px solid var(--border-light)',
                                    marginTop: '16px'
                                }}>
                                    <i className="fas fa-bolt" style={{ marginLeft: '4px' }}></i>
                                    ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù†Ù„Ø§ÛŒÙ† â€¢ Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: Ù‡Ù…ÛŒÙ† Ø­Ø§Ù„Ø§
                                </div>
                            </Card>
                            
                            {/* Footer */}
                            <Card>
                                <div style={{
                                    textAlign: 'center',
                                    padding: '16px 0'
                                }}>
                                    <div style={{
                                        fontSize: '12px',
                                        color: 'var(--text-muted)',
                                        marginBottom: '12px'
                                    }}>
                                        ØªÙˆØ³Ø¹Ù‡ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ ØªÙˆØ³Ø·
                                    </div>
                                    
                                    <div style={{
                                        display: 'flex',
                                        justifyContent: 'center',
                                        gap: '24px',
                                        marginBottom: '20px'
                                    }}>
                                        <a href="https://t.me/gheychiamoozesh" 
                                           target="_blank"
                                           rel="noopener noreferrer"
                                           style={{
                                               color: 'var(--accent-primary)',
                                               textDecoration: 'none',
                                               display: 'flex',
                                               alignItems: 'center',
                                               gap: '6px',
                                               fontSize: '14px',
                                               fontWeight: '500'
                                           }}>
                                            <i className="fab fa-telegram"></i>
                                            Ú©Ø§Ù†Ø§Ù„ Ø¢Ù…ÙˆØ²Ø´ÛŒ Ù‚ÛŒÚ†ÛŒ
                                        </a>
                                        
                                        <a href="https://t.me/shervinuri" 
                                           target="_blank"
                                           rel="noopener noreferrer"
                                           style={{
                                               color: 'var(--accent-secondary)',
                                               textDecoration: 'none',
                                               display: 'flex',
                                               alignItems: 'center',
                                               gap: '6px',
                                               fontSize: '14px',
                                               fontWeight: '500'
                                           }}>
                                            <i className="fas fa-code"></i>
                                            ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡
                                        </a>
                                    </div>
                                    
                                    <div style={{
                                        fontSize: '10px',
                                        color: 'var(--text-muted)',
                                        background: 'var(--bg-input)',
                                        padding: '12px',
                                        borderRadius: 'var(--radius-md)',
                                        border: '1px solid var(--border-light)'
                                    }}>
                                        <i className="fas fa-shield-alt" style={{ marginLeft: '4px' }}></i>
                                        Ø¨Ù‡ Ø§Ù…ÛŒØ¯ Ø¢Ø²Ø§Ø¯ÛŒ Ø§ÛŒØ±Ø§Ù† Ø¹Ø²ÛŒØ² .
                                    </div>
                                </div>
                            </Card>
                        </div>
                    </div>
                    
                    {/* Toast Notification */}
                    {toast && (
                        <Toast
                            message={toast.message}
                            type={toast.type}
                            onClose={() => setToast(null)}
                        />
                    )}
                </div>
            );
        };
        
        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
